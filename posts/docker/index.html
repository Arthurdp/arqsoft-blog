<!doctype html>

<html lang="en">

<head>
  <title>Docker - Documentação arquitetural usando o modelo C4 - Arquitetura de Software</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="Documentação arquitetural produzida pelas turmas de Arquitetura de Software - Computação @ UFCG." />
<meta name="author" content="Example" /><meta property="og:title" content="Docker - Documentação arquitetural usando o modelo C4" />
<meta property="og:description" content="Imagem de Julius Silver por Pixabay Julius Silver por  -- TLDR: Este documento apresenta uma sugestão para a documentação arquitetural do sistema de conteinerização Docker usando o modelo C4." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://joaoarthurbm.github.io/arqsoft-blog/posts/docker/" />
<meta property="article:published_time" content="2021-07-27T00:00:00-03:00" />
<meta property="article:modified_time" content="2021-07-27T00:00:00-03:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Docker - Documentação arquitetural usando o modelo C4"/>
<meta name="twitter:description" content="Imagem de Julius Silver por Pixabay Julius Silver por  -- TLDR: Este documento apresenta uma sugestão para a documentação arquitetural do sistema de conteinerização Docker usando o modelo C4."/>

<meta name="generator" content="Hugo 0.75.1" />
    

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://joaoarthurbm.github.io/arqsoft-blog/fontawesome/css/all.min.css" />
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  
  
  <link rel="stylesheet" type="text/css" href="https://joaoarthurbm.github.io/arqsoft-blog/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="https://joaoarthurbm.github.io/arqsoft-blog/">Arquitetura de Software</a>
            </h1>

      <ul id="social-media">
             <li>
               <a href="https://github.com/joaoarthurbm/arqsoft-blog" title="GitHub">
               <i class="fab fa-github fa-lg"></i>
               </a>
             </li>
      </ul>
      
      <p><em>Conteúdo produzido pelas turmas de Arquitetura de Software - Computação @ UFCG</em></p>
      
    </header>

    
<nav>
    <ul>
        
    </ul>
</nav>


    <main>




<article>

    <h1>Docker - Documentação arquitetural usando o modelo C4</h1>

    
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2021-07-27T00:00:00-03:00">Jul 27, 2021</time>
        </li>
        

        

        <li>4 minutes read</li>
    </ul>
</aside>

    

    


    <hr>
<p><img src="hamburg-3021820.jpg" alt=""></p>
<h6 id="imagem-de-julius-silverhttpspixabaycomptusersjulius_silver-4371822utm_sourcelink-attributionamputm_mediumreferralamputm_campaignimageamputm_content3021820-por-pixabayhttpspixabaycomptutm_sourcelink-attributionamputm_mediumreferralamputm_campaignimageamputm_content3021820">Imagem de <a href="https://pixabay.com/pt/users/julius_silver-4371822/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3021820">Julius Silver</a> por <a href="https://pixabay.com/pt/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3021820">Pixabay</a></h6>
<!-- Imagem de <a href="https://pixabay.com/pt/users/julius_silver-4371822/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3021820">Julius Silver</a> por <a href="https://pixabay.com/pt/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3021820"> </a> -->
<p><strong>TLDR:</strong> Este documento apresenta uma sugestão para a documentação arquitetural do sistema de
conteinerização Docker usando o modelo C4.
Entender bem como funciona esse sistema é importante, visto que os conceitos de containers linux
podem ser muito úteis para pessoas que trabalham com desenvolvimento de software.
É importante destacar que esse documento não descreve todos os detalhes da arquitetura do Docker.</p>
<hr>
<h2 id="autor">Autor</h2>
<p>Este documento foi produzido por Vinicius Barbosa da Silva.</p>
<ul>
<li>Matrícula: 117210708</li>
<li>Contato: <a href="mailto:vinicius.barbosa.silva@ccc.ufcg.edu.br">vinicius.barbosa.silva@ccc.ufcg.edu.br</a></li>
<li>Projeto documentado: <a href="https://github.com/docker/docker-ce">https://github.com/docker/docker-ce</a></li>
</ul>
<hr>
<h2 id="o-que-é-o-docker">O que é o Docker?</h2>
<p>Docker é um sistema de conteinerização que utiliza recursos do linux como namespaces e cgroups
para criar pacotes de software que são leves, isolados e que agrupam código, bibliotecas e
arquivos de configuração. A aplicação que roda em um container tem a impressão que o sistema
está sendo usado apenas por ela e, dessa forma, não consegue acessar os recursos e processos
de outros containers. Esse isolamento existe graças a funcionalidade de namespaces do linux.</p>
<p>O modelo de conteinerização pode ser muito eficaz para executar aplicações que não requerem uso exclusivo
dos servidores, já que são executados pelo mesmo kernel de um sistema operacional,sendo uma
ótima alternativa a virtualização tradicional com máquinas virtuais que levantam o SO inteiro
e acabam desperdiçando recursos.</p>
<p>Os containers são inicializados através de uma <a href="https://searchitoperations.techtarget.com/definition/Docker-image">Imagem</a> base que pode vir de registros privados ou públicos
como o <a href="https://hub.docker.com/">docker hub</a>, por exemplo. As imagens são construídas por camadas e podem vir
pre-configuradas com um software de interesse da aplicação que rodará no container. Exemplos de imagens: mysql, ubuntu, alpine, nginx, apache, etc.
Mais detalhes sobre o projeto Docker e sobre containers podem ser vistos <a href="https://www.docker.com/resources/what-container">aqui</a>.</p>
<p><img src="docker-filesystems-multilayer.png" alt="docker-multilayer"></p>
<h6 id="imagem-retirada-de-3httpsraginmediumcomdocker-what-it-is-how-images-are-structured-docker-vs-vm-and-some-tips-part-1-d9686303590f-nela-podemos-ver-que-o-container-roda-em-cima-de-uma-imagem-composta-por-diversas-camadas-onde-cada-uma-possui-um-software-específico-é-importante-mencionar-que-na-base-existe-um-mini-sistema-operacional-que-no-caso-desse-exemplo-é-o-alpine-linux">Imagem retirada de [<a href="https://ragin.medium.com/docker-what-it-is-how-images-are-structured-docker-vs-vm-and-some-tips-part-1-d9686303590f">3</a>]. Nela, podemos ver que o container roda em cima de uma imagem composta por diversas camadas, onde cada uma possui um software específico. É importante mencionar que na base existe um &ldquo;mini sistema operacional&rdquo;, que no caso desse exemplo é o alpine linux</h6>
<h2 id="diagrama-de-contexto">Diagrama de Contexto</h2>
<p>No centro temos o sistema principal, o Docker, que prove serviços para criar, executar, atualizar, gerenciar containers linux.</p>
<p>O Docker pode ser usado de duas maneiras: via CLI ou usando a API diretamente. Ambas as formas produzem o mesmo resultado, apenas a forma de fazer que muda.
Isso permite que sistemas externos como o <a href="https://kubernetes.io/pt-br/">Kubernetes</a> usem o Docker com facilidade.</p>
<p>O sistema Docker utiliza um serviço externo de registro de imagens, que pode ser público (como o <a href="https://hub.docker.com/">Dockerhub</a>) ou um registro privado de uma empresa particular</p>
<p><img src="diagrama-contexto.png" alt="context_diagram"></p>
<h2 id="diagrama-de-containers">Diagrama de Containers</h2>
<p>Os componentes internos do Docker incluem a <strong>CLI</strong>, <strong>API application</strong> e o <strong>Docker storage directory</strong>.</p>
<p>A <strong>CLI</strong> é implementada em golang e <a href="https://github.com/docker/cli/blob/master/cli/cobra.go">usa a biblioteca Cobra</a>(<a href="https://github.com/spf13/cobra">ver library</a>) para se comunicar com a RESTful API application.</p>
<p>A RESTful <strong>API application</strong> fornece seus serviços por meio do protocolo HTTP (<a href="https://docs.docker.com/engine/api/">ver mais</a>). Essa api faz a conexão entre a CLI ou aplicação que usa a api diretamente com o deamon do Docker (chamado <a href="https://docs.docker.com/engine/api/v1.41/#">Docker Engine API</a>), que é o core do Docker e que será melhor descrito no diagrama de componentes.</p>
<p>O <strong>Docker storage directory</strong> é responsável por armazenar os dados dos containers (o filesystem e seus volumes) e as imagens que foram baixadas do registro. Por default, o repositório se encontra em <code>/var/lib/docker</code>, mas pode ser trocado para qualquer outro diretório
do sistema de arquivos, por exemplo, em um disco externo: <code>/mnt/disk3/docker</code>.</p>
<p><img src="diagrama-container.png" alt="container_diagram"></p>
<h2 id="diagrama-de-componentes">Diagrama de Componentes</h2>
<p>Os componentes internos da <strong>API Application</strong> foram representados por: <strong>Docker Daemon</strong>, <strong>Kernel Component</strong>, <strong>Container Component</strong> e <strong>Image Component</strong>.</p>
<p>O <strong>Docker Component</strong> é responsável por receber as requisições da API e utilizar os demais componentes internos (Kernel, Image, Container component) para entregar resultado para o cliente, isto é, criar e gerenciar os containers.</p>
<p>O <strong>Kernel Component</strong> existe para lidar com o sistema operacional linux e pedir recursos para a criação de containers como namespaces e cgroups.</p>
<p>O <strong>Container Component</strong> lida com o gerenciamento dos containers.</p>
<p>O <strong>Image Component</strong> lida com o gerenciamento, criação de imagens e download/envio de imagens para o registro.</p>
<p><img src="diagrama-componentes.png" alt="components_diagram"></p>
<h2 id="diagrama-da-visão-de-informação">Diagrama da Visão de Informação</h2>
<h3 id="ciclo-de-vida-de-um-container">Ciclo de vida de um container</h3>
<p>Os containers docker possuem 5 estados principais: <code>CREATED</code>, <code>RUNNING</code>, <code>PAUSED</code>, <code>STOPPED</code> e <code>DELETED</code>.</p>
<p>O primeiro estado, <strong>CREATED</strong>, é atingido através do comando <em>docker create</em>, estando pronto para seguir para um dos proximos estados: <strong>RUNNING</strong> (via <em>docker start</em>) ou <strong>DELETED</strong> (via <em>docker rm</em>)</p>
<p>O container quando está no estado <strong>RUNNING</strong>, pode ter diversos caminhos:</p>
<ul>
<li>
<p>ser pausado e passar para o estado <strong>PAUSED</strong> (via <em>docker pause</em>) e possivelmente voltar para o estado <strong>RUNNING</strong> (via <em>docker unpause</em>)</p>
</li>
<li>
<p>ser reiniciado via <em>docker restart</em></p>
</li>
<li>
<p>ser parado e passar para o estado <strong>STOPPED</strong> (via <em>docker kill</em> ou <em>docker stop</em>)</p>
</li>
</ul>
<p>E por fim, temos o estado <strong>DELETED</strong>, que é atingido ao usarmos o comando <em>docker rm</em>.</p>
<p><img src="event_state.png" alt="components_diagram"></p>
<h6 id="diagrama-do-ciclo-de-vida-dos-containers-feito-por-docker-saigonhttpdocker-saigongithubiopostdocker-internals-2">Diagrama do ciclo de vida dos containers feito por <a href="http://docker-saigon.github.io/post/Docker-Internals">Docker Saigon</a> [2]</h6>
<h2 id="referencias">Referencias</h2>
<ol>
<li><a href="https://www.docker.com/products/container-runtime">https://www.docker.com/products/container-runtime</a></li>
<li><a href="http://docker-saigon.github.io/post/Docker-Internals">http://docker-saigon.github.io/post/Docker-Internals</a></li>
<li><a href="https://ragin.medium.com/docker-what-it-is-how-images-are-structured-docker-vs-vm-and-some-tips-part-1-d9686303590f">https://ragin.medium.com/docker-what-it-is-how-images-are-structured-docker-vs-vm-and-some-tips-part-1-d9686303590f</a></li>
</ol>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://joaoarthurbm.github.io/arqsoft-blog/posts/ecommerce/"><i class="fa fa-chevron-circle-left"></i> Website de e-commerce com Django</a>
        </li>
        
        
        <li>
            <a href="https://joaoarthurbm.github.io/arqsoft-blog/posts/ceph/">Documentação arquitetural do Ceph <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
  
    
    
  





</main>
    <footer>
        <h6>Copyright © Turma de Arquitetura de Software UFCG |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://joaoarthurbm.github.io/arqsoft-blogindex.xml">Subscribe </a></h6>
    </footer>
</div>
<script src="https://joaoarthurbm.github.io/arqsoft-blog/js/scripts.js"></script>

</body>

</html>

